{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap 5b9ad0c48605a419fa64","webpack:///./src/jpeg/index.js","webpack:///./src/jpeg/sections.js","webpack:///./src/jpeg/decoder.js","webpack:///./src/jpeg/quantGlitcher.js","webpack:///./src/utils/index.js","webpack:///./src/index.js","webpack:///./src/jpeg/parsers.js"],"names":["Jpeg","copy","getSections","data","type","sections","subarray","sectionName","jpeg","filter","section","Section","STARTBYTE","PADBYTE","SOF0","name","tag","Uint8Array","SOF2","DHT","DQT","SOS","SOI","EOI","COM","APP","upper","lower","size","position","decodeJpeg","parsers","getParser","firstTagByte","secondTagByte","find","p","parses","decodeJpegRecur","imageData","length","Error","toString","parser","undefined","parseData","newPosition","concat","glitchQuantisationTable","randomQuantGlitch","g","Math","random","floor","map","s","jpegFromCanvas","imageFromJpeg","fileToUint8","cb","event","target","result","canvasElem","quality","toBlob","r","FileReader","onload","readAsArrayBuffer","blob","console","log","objurl","URL","createObjectURL","Blob","img","Image","src","utils","JpegSectionParser","pTag","pTagSize","segmentStart","segmentSize","JpegSOIParser","JpegEOIParser","JpegSOSParser","segmentHeaderSize","i","finalSize","JpegAPPParser","pTagUpper","pTagLower"],"mappings":"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","file":"glitchlib.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"glitchlib\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"glitchlib\"] = factory();\n\telse\n\t\troot[\"glitchlib\"] = factory();\n})(this, function() {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 5);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 5b9ad0c48605a419fa64","import decodeJpeg from './decoder';\n\nexport function Jpeg(data) {\n  return {\n    type: 'jpeg',\n    data,\n    sections: decodeJpeg(data),\n  };\n}\n\nexport function copy({ data }) {\n  // results in reparsing the new jpeg\n  // may or may not be a bad idea\n  return Jpeg(data.subarray());\n}\n\nexport function getSections(sectionName, jpeg) {\n  return jpeg.sections.filter(({ section }) => section === sectionName);\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/jpeg/index.js","export const STARTBYTE = 0xff;\nexport const PADBYTE = 0x00;\nexport const SOF0 = { name: 'SOF0', tag: new Uint8Array([STARTBYTE, 0xc0]) };\nexport const SOF2 = { name: 'SOF2', tag: new Uint8Array([STARTBYTE, 0xc2]) };\nexport const DHT = { name: 'DHT', tag: new Uint8Array([STARTBYTE, 0xc4]) };\nexport const DQT = { name: 'DQT', tag: new Uint8Array([STARTBYTE, 0xdb]) };\nexport const SOS = { name: 'SOS', tag: new Uint8Array([STARTBYTE, 0xda]) };\nexport const SOI = { name: 'SOI', tag: new Uint8Array([STARTBYTE, 0xd8]) };\nexport const EOI = { name: 'EOI', tag: new Uint8Array([STARTBYTE, 0xd9]) };\nexport const COM = { name: 'COM', tag: new Uint8Array([STARTBYTE, 0xfe]) };\nexport const APP = {\n  name: 'SOS',\n  upper: new Uint8Array([STARTBYTE, 0xef]),\n  lower: new Uint8Array([STARTBYTE, 0xe0]),\n  tag: new Uint8Array([STARTBYTE, 0xe0]),\n};\n\nexport function Section(section, size, position) {\n  return {\n    section,\n    size,\n    position,\n  };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/jpeg/sections.js","import {\n  JpegSectionParser,\n  JpegSOIParser,\n  JpegSOSParser,\n  JpegEOIParser,\n  JpegAPPParser,\n} from './parsers';\n\nimport { STARTBYTE, SOF0, SOF2, DHT, DQT, COM } from './sections';\n\nconst parsers = [\n  new JpegSOIParser(),\n  new JpegSectionParser(SOF0),\n  new JpegSectionParser(SOF2),\n  new JpegSectionParser(DHT),\n  new JpegSectionParser(DQT),\n  new JpegSOSParser(),\n  new JpegAPPParser(),\n  new JpegSectionParser(COM),\n  new JpegEOIParser(),\n];\n\nfunction getParser(firstTagByte, secondTagByte) {\n  return parsers.find(p => p.parses(firstTagByte, secondTagByte));\n}\n\nfunction decodeJpegRecur(imageData, sections, position) {\n  if (position >= imageData.length) {\n    return sections;\n  }\n  const firstTagByte = imageData[position];\n  const secondTagByte = imageData[position + 1];\n  if (firstTagByte !== STARTBYTE) {\n    throw new Error(`Invalid initial tag value: ${firstTagByte.toString(16)}`);\n  }\n  const parser = getParser(firstTagByte, secondTagByte);\n  if (parser === undefined) {\n    throw new Error(`Could not find parser for ${secondTagByte.toString(16)}`);\n  }\n  const section = parser.parseData(imageData, position);\n  const newPosition = position + section.size;\n  return decodeJpegRecur(imageData, sections.concat([section]), newPosition);\n}\n\n// imageData should be a Uint8Array\nexport default function decodeJpeg(imageData) {\n  return decodeJpegRecur(imageData, [], 0);\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/jpeg/decoder.js","import { getSections } from './index';\nimport { DQT } from './sections';\n\nexport function glitchQuantisationTable(jpeg, section) {\n  let p;\n  let g;\n  for (p = section.position + 2; p < section.position + section.size; p += 1) {\n    if (Math.random() < 0.1) {\n      g = Math.floor(Math.random() * 253 + 1);\n      jpeg.data[p] = g;\n    }\n  }\n}\n\nexport function randomQuantGlitch(jpeg) {\n  getSections(DQT.name, jpeg).map(s => glitchQuantisationTable(jpeg, s));\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/jpeg/quantGlitcher.js","import { Jpeg } from 'jpeg';\n\nexport const fileToUint8 = cb => event => {\n  cb(Jpeg(new Uint8Array(event.target.result)));\n};\n\nexport function jpegFromCanvas(canvasElem, cb, quality = 0.95) {\n  canvasElem.toBlob(\n    blob => {\n      var r = new FileReader();\n      r.onload = fileToUint8(cb);\n      r.readAsArrayBuffer(blob);\n    },\n    'image/jpeg',\n    quality\n  );\n}\n\nexport function imageFromJpeg(jpeg, cb) {\n  console.log('loading image from jpeg');\n  const objurl = URL.createObjectURL(new Blob([jpeg.data]), {\n    type: 'image/jpeg',\n  });\n  const img = new Image();\n  img.onload = () => {\n    console.log('image loaded');\n    cb(img);\n  };\n  img.src = objurl;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/utils/index.js","import decodeJpeg from 'jpeg/decoder';\nimport { randomQuantGlitch } from 'jpeg/quantGlitcher';\nimport * as Jpeg from 'jpeg';\n\nimport * as utils from 'utils';\n\nexport { decodeJpeg, randomQuantGlitch, utils, Jpeg };\n\n\n\n// WEBPACK FOOTER //\n// ./src/index.js","import { STARTBYTE, PADBYTE, SOI, SOS, APP, EOI, Section } from './sections';\n\nexport class JpegSectionParser {\n  constructor(section) {\n    this.pTag = section.tag;\n    this.name = section.name;\n    this.pTagSize = section.tag.length;\n  }\n  parses(firstTagByte, secondTagByte) {\n    return this.pTag[0] === firstTagByte && this.pTag[1] === secondTagByte;\n  }\n  parseData(data, position) {\n    // Section size does not include initial tag\n    const segmentStart = position + this.pTagSize;\n    const segmentSize = data[segmentStart] * 8 + data[segmentStart + 1];\n    const size = this.pTagSize + segmentSize;\n    return Section(this.name, size, position);\n  }\n}\n\nexport class JpegSOIParser extends JpegSectionParser {\n  constructor() {\n    super(SOI);\n  }\n  parseData(data, position) {\n    // This is the opening tag so it's only ever 2 bytes\n    const size = 2;\n    return Section(this.name, size, position);\n  }\n}\n\nexport class JpegEOIParser extends JpegSectionParser {\n  constructor() {\n    super(EOI);\n  }\n  parseData(data, position) {\n    // This is the closing tag so it's only ever 2 bytes\n    const size = 2;\n    return Section(this.name, size, position);\n  }\n}\n\nexport class JpegSOSParser extends JpegSectionParser {\n  constructor() {\n    super(SOS);\n  }\n  parseData(data, position) {\n    // Section size does not include initial tag\n    const segmentStart = position + this.pTagSize;\n    const segmentSize = data[segmentStart] * 8 + data[segmentStart + 1];\n    const segmentHeaderSize = this.pTagSize + segmentSize;\n    let i;\n    for (i = position + segmentHeaderSize; i < data.length; i += 1) {\n      if (data[i] === STARTBYTE && data[i + 1] !== PADBYTE) {\n        break;\n      }\n    }\n    const finalSize = i - position;\n    return Section(this.name, finalSize, position);\n  }\n}\n\nexport class JpegAPPParser extends JpegSectionParser {\n  constructor() {\n    super(APP);\n    this.pTagUpper = APP.upper;\n    this.pTagLower = APP.lower;\n  }\n  parses(firstTagByte, secondTagByte) {\n    return (\n      this.pTagLower[0] === firstTagByte &&\n      this.pTagLower[1] <= secondTagByte &&\n      this.pTagUpper[1] >= secondTagByte\n    );\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/jpeg/parsers.js"],"sourceRoot":""}