{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap e56a9ee160ad5fe3673f","webpack:///./src/jpeg/sections.js","webpack:///./src/jpeg/decoder.js","webpack:///./src/jpeg/quantGlitcher.js","webpack:///./src/index.js","webpack:///./src/jpeg/parsers.js"],"names":["Section","STARTBYTE","PADBYTE","SOF0","name","tag","Uint8Array","SOF2","DHT","DQT","SOS","SOI","EOI","COM","APP","upper","lower","section","size","position","decodeJpeg","parsers","getParser","firstTagByte","secondTagByte","find","p","parses","decodeJpegRecur","imageData","sections","length","Error","toString","parser","undefined","parseData","newPosition","concat","randomQuantGlitch","forEach","s","g","Math","random","floor","console","log","JpegSectionParser","pTag","pTagSize","data","segmentStart","segmentSize","JpegSOIParser","JpegEOIParser","JpegSOSParser","segmentHeaderSize","i","finalSize","JpegAPPParser","pTagUpper","pTagLower"],"mappings":"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","file":"glitchlib.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"glitchlib\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"glitchlib\"] = factory();\n\telse\n\t\troot[\"glitchlib\"] = factory();\n})(this, function() {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 3);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap e56a9ee160ad5fe3673f","export const STARTBYTE = 0xff;\nexport const PADBYTE = 0x00;\nexport const SOF0 = { name: 'SOF0', tag: new Uint8Array([STARTBYTE, 0xc0]) };\nexport const SOF2 = { name: 'SOF2', tag: new Uint8Array([STARTBYTE, 0xc2]) };\nexport const DHT = { name: 'DHT', tag: new Uint8Array([STARTBYTE, 0xc4]) };\nexport const DQT = { name: 'DQT', tag: new Uint8Array([STARTBYTE, 0xdb]) };\nexport const SOS = { name: 'SOS', tag: new Uint8Array([STARTBYTE, 0xda]) };\nexport const SOI = { name: 'SOI', tag: new Uint8Array([STARTBYTE, 0xd8]) };\nexport const EOI = { name: 'EOI', tag: new Uint8Array([STARTBYTE, 0xd9]) };\nexport const COM = { name: 'COM', tag: new Uint8Array([STARTBYTE, 0xfe]) };\nexport const APP = {\n  name: 'SOS',\n  upper: new Uint8Array([STARTBYTE, 0xef]),\n  lower: new Uint8Array([STARTBYTE, 0xe0]),\n  tag: new Uint8Array([STARTBYTE, 0xe0]),\n};\n\nexport function Section(section, size, position) {\n  return {\n    section,\n    size,\n    position,\n  };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/jpeg/sections.js","import {\n  JpegSectionParser,\n  JpegSOIParser,\n  JpegSOSParser,\n  JpegEOIParser,\n  JpegAPPParser,\n} from './parsers';\n\nimport { STARTBYTE, SOF0, SOF2, DHT, DQT, COM } from './sections';\n\nconst parsers = [\n  new JpegSOIParser(),\n  new JpegSectionParser(SOF0),\n  new JpegSectionParser(SOF2),\n  new JpegSectionParser(DHT),\n  new JpegSectionParser(DQT),\n  new JpegSOSParser(),\n  new JpegAPPParser(),\n  new JpegSectionParser(COM),\n  new JpegEOIParser(),\n];\n\nfunction getParser(firstTagByte, secondTagByte) {\n  return parsers.find(p => p.parses(firstTagByte, secondTagByte));\n}\n\nfunction decodeJpegRecur(imageData, sections, position) {\n  if (position >= imageData.length) {\n    return sections;\n  }\n  const firstTagByte = imageData[position];\n  const secondTagByte = imageData[position + 1];\n  if (firstTagByte !== STARTBYTE) {\n    throw new Error(`Invalid initial tag value: ${firstTagByte.toString(16)}`);\n  }\n  const parser = getParser(firstTagByte, secondTagByte);\n  if (parser === undefined) {\n    throw new Error(`Could not find parser for ${secondTagByte.toString(16)}`);\n  }\n  const section = parser.parseData(imageData, position);\n  const newPosition = position + section.size;\n  return decodeJpegRecur(imageData, sections.concat([section]), newPosition);\n}\n\n// imageData should be a Uint8Array\nexport default function decodeJpeg(imageData) {\n  return decodeJpegRecur(imageData, [], 0);\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/jpeg/decoder.js","import { DQT } from './sections';\n\nexport function randomQuantGlitch(imageData, sections) {\n  sections.forEach(s => {\n    if (s.section === DQT.name) {\n      let p;\n      let g;\n      for (p = s.position + 2; p < s.position + s.size; p += 1) {\n        if (Math.random() < 0.1) {\n          g = Math.floor(Math.random() * 253 + 1);\n          console.log(imageData[p], g);\n          imageData[p] = g;\n        }\n      }\n    }\n  });\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/jpeg/quantGlitcher.js","import decodeJpeg from 'jpeg/decoder';\nimport { randomQuantGlitch } from 'jpeg/quantGlitcher';\n\nexport { decodeJpeg, randomQuantGlitch };\n\n\n\n// WEBPACK FOOTER //\n// ./src/index.js","import { STARTBYTE, PADBYTE, SOI, SOS, APP, EOI, Section } from './sections';\n\nexport class JpegSectionParser {\n  constructor(section) {\n    this.pTag = section.tag;\n    this.name = section.name;\n    this.pTagSize = section.tag.length;\n  }\n  parses(firstTagByte, secondTagByte) {\n    return this.pTag[0] === firstTagByte && this.pTag[1] === secondTagByte;\n  }\n  parseData(data, position) {\n    // Section size does not include initial tag\n    const segmentStart = position + this.pTagSize;\n    const segmentSize = data[segmentStart] * 8 + data[segmentStart + 1];\n    const size = this.pTagSize + segmentSize;\n    return Section(this.name, size, position);\n  }\n}\n\nexport class JpegSOIParser extends JpegSectionParser {\n  constructor() {\n    super(SOI);\n  }\n  parseData(data, position) {\n    // This is the opening tag so it's only ever 2 bytes\n    const size = 2;\n    return Section(this.name, size, position);\n  }\n}\n\nexport class JpegEOIParser extends JpegSectionParser {\n  constructor() {\n    super(EOI);\n  }\n  parseData(data, position) {\n    // This is the closing tag so it's only ever 2 bytes\n    const size = 2;\n    return Section(this.name, size, position);\n  }\n}\n\nexport class JpegSOSParser extends JpegSectionParser {\n  constructor() {\n    super(SOS);\n  }\n  parseData(data, position) {\n    // Section size does not include initial tag\n    const segmentStart = position + this.pTagSize;\n    const segmentSize = data[segmentStart] * 8 + data[segmentStart + 1];\n    const segmentHeaderSize = this.pTagSize + segmentSize;\n    let i;\n    for (i = position + segmentHeaderSize; i < data.length; i += 1) {\n      if (data[i] === STARTBYTE && data[i + 1] !== PADBYTE) {\n        break;\n      }\n    }\n    const finalSize = i - position;\n    return Section(this.name, finalSize, position);\n  }\n}\n\nexport class JpegAPPParser extends JpegSectionParser {\n  constructor() {\n    super(APP);\n    this.pTagUpper = APP.upper;\n    this.pTagLower = APP.lower;\n  }\n  parses(firstTagByte, secondTagByte) {\n    return (\n      this.pTagLower[0] === firstTagByte &&\n      this.pTagLower[1] <= secondTagByte &&\n      this.pTagUpper[1] >= secondTagByte\n    );\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/jpeg/parsers.js"],"sourceRoot":""}